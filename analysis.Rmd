---
title: "analysis"
output: pdf_document
---

- indoor vs outdoor
- similar vs nonsimilar by year
- determine threshold
- make presentation
- think of another visual
- seperate by season
- conditions of mlr




```{r}
require(tidyverse)
require(mosaic)
require(lme4)
```

## load dataset
```{r}
load("olympics9.Rdata")
olympicsds <-  olympics9
```



## Very Basic Graphs
```{r}
olympicsds %>%
  ggplot(aes(x = elevdiff)) + geom_density()

olympicsds %>%
  filter(Season == "Winter") %>%
  ggplot(aes(x = elevdiff, y = medratio)) + geom_point()

olympicsds
```



```{r}
formodel1<- olympicsds %>%
  filter(Season == "Summer", !is.na(tempdiff), !is.na(elevdiff))
  

formodel

summary(lmer(medratio ~ tempdiff + elevdiff + (1|region), data = formodel1))
```



#Finding Thresholds for "Similar/Nonsimilar temp/elev"
```{r}
olympics9
favstats(~tempdiff, data=olympics9)
favstats(~elevdiff, data=olympics9)

olympicsds%>%
ggplot(aes(x=tempdiff))+
  geom_density()+
  geom_vline(xintercept=-11.41662)+
  geom_vline(xintercept=1.760962)
  

olympicsds%>%
ggplot(aes(x=elevdiff))+
  geom_density()+
  geom_vline(xintercept=-573.75)+
  geom_vline(xintercept=-32.25)



olympicsds1 <- olympicsds %>%
  mutate(sim = ifelse((tempdiff>-11.41662 & tempdiff<1.760962) & (elevdiff>-573.75 & elevdiff<32.25), 1, 0),
         sim = as.factor(sim)) 


olympicsds1 %>%
  filter(region == "Germany") %>%
  ggplot(aes(x = elevdiff, y = medratio, col = Season, )) + geom_point() 
  



olympicsds2 <- olympicsds1 %>%
  filter(region %in% c("Australia", "Germany", "UK")) %>%
  filter(!is.na(elevdiff), !is.na(tempdiff), Season == "Summer")


olympicsds2 %>%
  filter(!(elevdiff > 1500)) %>%
  ggplot(aes(x = elevdiff, y = tempdiff)) + geom_point(size = 2.0) + 
   aes(color = medratio)  +  facet_wrap(~region, ncol = 4) +
  theme(legend.position = "right") + labs(title = "") + scale_color_gradient(low = "yellow", high = "blue") +
  labs(x = "Elevation Difference (Meter)", y = "Temperature Difference (Degree Celcius)", title = "Medal Ratio by Temperature and Elevation Difference in 3 Countries", color = "Medal Ratio") 
```


## Creating graphics for showing LMM
```{r}
set.seed(10)
x <- runif(250, min = 0, max = 200)
cat <- c(rep("1",50),rep("2",50),rep("3",50),rep("4",50),rep("5",50))
move <- c(rep(0,50),rep(200,50),rep(50,50),rep(75,50),rep(-25,50))
error <- rnorm(250, 0, 30)


bob <- data.frame(x, cat, move, error) %>%
  mutate(y = x * 2 + move + error)


ggplot(bob, aes(x = x, y = y)) + geom_point() + 
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE)

ggplot(bob, aes(x = x, y = y, col = cat)) + geom_point() + 
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE)
```


