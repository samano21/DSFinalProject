---
title: "analysis"
output: pdf_document
---

- indoor vs outdoor
- similar vs nonsimilar by year
- determine threshold
- make presentation
- think of another visual
- seperate by season
- conditions of mlr




```{r}
require(tidyverse)
require(mosaic)
require(lme4)
```

## load dataset
```{r}
load("olympics9.Rdata")
olympicsds <-  olympics9
```



## Very Basic Graphs
```{r}
olympicsds %>%
  ggplot(aes(x = elevdiff)) + geom_density()

olympicsds %>%
  filter(Season == "Winter") %>%
  ggplot(aes(x = elevdiff, y = medratio)) + geom_point()

olympicsds
```



```{r}
formodel1<- olympicsds %>%
  filter(Season == "Summer", !is.na(tempdiff), !is.na(elevdiff))
  

formodel

summary(lmer(medratio ~ tempdiff + elevdiff + (1|region), data = formodel1))
```



#Finding Thresholds for "Similar/Nonsimilar temp/elev"
```{r}
olympics9
favstats(~tempdiff, data=olympics9)
favstats(~elevdiff, data=olympics9)

olympicsds%>%
ggplot(aes(x=tempdiff))+
  geom_density()+
  geom_vline(xintercept=-11.41662)+
  geom_vline(xintercept=1.760962)
  

olympicsds%>%
ggplot(aes(x=elevdiff))+
  geom_density()+
  geom_vline(xintercept=-573.75)+
  geom_vline(xintercept=-32.25)



olympicsds1 <- olympicsds %>%
  mutate(sim = ifelse((tempdiff>-11.41662 & tempdiff<1.760962) & (elevdiff>-573.75 & elevdiff<32.25), 1, 0),
         sim = as.factor(sim)) 


olympicsds1 %>%
  filter(region == "Germany") %>%
  ggplot(aes(x = elevdiff, y = medratio, col = Season, )) + geom_point() 
  



olympicsds2 <- olympicsds1 %>%
  filter(region %in% c("Australia", "Germany", "UK")) %>%
  filter(!is.na(elevdiff), !is.na(tempdiff), Season == "Summer")


olympicsds2 %>%
  filter(!(elevdiff > 1500)) %>%
  ggplot(aes(x = elevdiff, y = tempdiff)) + geom_point(size = 3.0) + 
   aes(color = medratio)  +  facet_wrap(~region, ncol = 4) +
  theme(legend.position = "right") + labs(title = "") + scale_color_gradient(low = "yellow", high = "blue") +
  labs(x = "Elevation Difference (Meter)", y = "Temperature Difference (Degree Celcius)", title = "Medal Ratio by Temperature and Elevation Difference in 3 Countries", color = "Medal Ratio") 
```


## Creating graphics for showing LMM
```{r}
set.seed(5)
X <- c(runif(50, min = 0, max = 200),0,runif(50, min = 0, max = 200),0,runif(50, min = 0, max = 200),0,runif(50, min = 0, max = 200),0,runif(50, min = 0, max = 200),0)
Factors <- c(rep("1",51),rep("2",51),rep("3",51),rep("4",51),rep("5",51))
move <- c(rep(0,51),rep(200,51),rep(50,51),rep(75,51),rep(-25,51))
error <- rnorm(255, 0, 30)
mult <- c(rep(3,51),rep(1.7,51),rep(0.7,51),rep(2,51),rep(2.3,51))


bob <- data.frame(X, Factors, move, error) %>%
  mutate(Y = X * 2 + move + error)

bob %>%
  filter(Factors == "1") %>% 
  ggplot(aes(x = X, y = Y)) + geom_point() + 
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
  labs(title = "Graph with 1 Factor")

ggplot(bob, aes(x = X, y = Y, col = Factors)) + geom_point() + 
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) + 
  labs(title = "Graph with 5 Factors")
```

## generate plot of what we expected
```{r}
set.seed(10)
elev <- rnorm(30, 0, 200)
temp <- rnorm(30, 0, 4)

expected <- data.frame(elev, temp) %>%
  mutate(dist = sqrt((elev/200)^2 + (temp/4)^2),
         dist = (1 - dist/max(dist)) * 0.3)

ggplot(expected, aes(x = elev, y = temp, col = dist)) + geom_point() +
  labs(x = "Elevation Difference (Meter)", y = "Temperature Difference (Degree Celcius)", title = "Expected Graph: Medal Ratio by Temperature and Elevation Difference", color = "Medal Ratio") + scale_color_gradient(low = "yellow", high = "blue") + 
  geom_vline(xintercept = 0) + geom_hline(yintercept = 0)
```




